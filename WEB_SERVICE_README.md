# 古诗词平仄分析器 - Web服务

一个基于Flask的古诗词平仄分析Web应用，可以智能识别词牌名、分析平仄合规性并标注韵脚韵部。

## 功能特点

- 🎯 **智能词牌识别**：根据字数和分段自动识别词牌名
- 📊 **平仄分析**：准确标注每个字的平仄属性并计算合规得分
- 🎵 **韵脚分析**：识别韵脚字并标注对应韵部
- 📚 **多韵书支持**：支持词林正韵和中华新韵
- 📖 **多词牌谱**：支持钦定词谱和唐宋词格律
- 🎨 **美观界面**：现代化中式设计风格，响应式布局
- ⚡ **实时分析**：异步处理，快速响应

## 系统要求

- Python 3.7+
- 现代Web浏览器（支持ES6+）

## 安装步骤

### 1. 克隆或下载项目

确保您已经有完整的项目文件，包括：
```
jiaxuan/
├── app.py                    # Flask应用主文件
├── requirements.txt          # Python依赖
├── templates/
│   └── index.html           # 主页模板
├── static/
│   ├── css/
│   │   └── style.css        # 样式文件
│   └── js/
│       └── script.js        # JavaScript交互
├── data/                    # 数据文件目录
│   ├── 词林正韵.json
│   ├── 中华新韵.json
│   ├── cipai_with_statistics_qdcp.csv
│   ├── cipai_with_statistics_tscgl.csv
│   └── yunjiao.csv
└── script/                  # 原始脚本文件
```

### 2. 安装Python依赖

在项目根目录下运行：

```bash
# 推荐先创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

### 3. 启动Web服务

```bash
python app.py
```

看到类似以下输出说明启动成功：
```
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://[您的IP]:5000
```

### 4. 访问Web应用

打开浏览器，访问：
- 本地访问：http://localhost:5000
- 局域网访问：http://您的IP地址:5000

## 使用方法

### 基本操作

1. **输入诗词文本**：在文本框中输入要分析的古诗词
2. **选择韵书**：
   - 词林正韵：传统韵书
   - 中华新韵：现代韵书（推荐）
3. **选择词牌谱**：
   - 钦定词谱：清代官方词谱（推荐）
   - 唐宋词格律：基于唐宋词的格律总结
4. **开始分析**：点击"开始分析"按钮

### 快速体验

双击文本输入框可以自动填入示例诗词，快速体验分析功能。

### 分析结果说明

分析完成后会显示：

- **识别词牌**：系统识别的词牌名和参考作者
- **文本统计**：总字数和分段字数
- **平仄得分**：平仄合规性评分（0-100%）
  - 绿色（90%+）：优秀
  - 橙色（70%-89%）：良好  
  - 红色（<70%）：需要改进
- **平仄标注**：每个字的平仄标注
  - 青色：平声字
  - 红色：仄声字
  - 灰色：未知声调
- **不合平仄的字**：列出所有不符合格律的字及应有声调
- **韵脚字**：词中的韵脚字
- **韵脚韵部**：韵脚字所属的韵部

## 技术架构

### 后端（Flask）
- `app.py`：主应用文件，包含所有分析逻辑
- 路由：
  - `/`：主页
  - `/analyze`：分析接口（POST）

### 前端
- **HTML5**：语义化结构
- **CSS3**：现代样式设计，支持响应式布局
- **JavaScript ES6+**：异步处理，动态交互

### 数据文件
- **韵书文件**：JSON格式的平仄和韵部数据
- **词牌谱文件**：CSV格式的词牌格律数据
- **韵脚文件**：CSV格式的韵脚位置数据

## 常见问题

### Q: 启动时提示找不到数据文件？
A: 确保 `data/` 目录下有所有必需的数据文件，检查文件路径是否正确。

### Q: 分析结果显示"未能匹配到词牌名"？
A: 这可能是因为：
- 输入的文本字数或分段与数据库中的词牌不匹配
- 文本格式不规范（包含过多标点符号等）

### Q: 平仄标注显示很多"未知"？
A: 可能是因为：
- 使用了生僻字或异体字
- 韵书数据库中没有收录该字
- 可以尝试切换不同的韵书

### Q: 如何添加新的词牌或韵书？
A: 可以编辑 `data/` 目录下对应的数据文件，按照现有格式添加新数据。

## 自定义配置

### 修改端口
在 `app.py` 最后一行修改：
```python
app.run(debug=True, host='0.0.0.0', port=您的端口号)
```

### 修改默认选项
在 `templates/index.html` 中修改对应的 `selected` 属性。

## 版本信息

- **当前版本**：1.0.0
- **开发语言**：Python 3.7+
- **Web框架**：Flask 2.3.3
- **前端技术**：HTML5 + CSS3 + JavaScript ES6

## 许可证

本项目采用 MIT 许可证。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

---

如果您在使用过程中遇到任何问题，请随时联系开发者或提交 Issue。 